# 鼠标模拟点击工具

一个功能强大的鼠标自动化操作工具，提供命令行和图形界面两种使用方式。

## 功能特性

- ✅ 单击、双击、右键点击
- ✅ 连续点击（可设置次数和间隔）
- ✅ 拖拽操作
- ✅ 获取鼠标位置
- ✅ 命令行界面
- ✅ 图形用户界面
- ✅ 安全保护（鼠标移到左上角自动停止）

## 环境设置

### 方法一：使用虚拟环境（推荐）

```bash
# 创建虚拟环境
python3 -m venv venv

# 激活虚拟环境
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

或者直接使用提供的脚本：

```bash
# 自动创建虚拟环境并安装依赖
./activate_env.sh

# 退出虚拟环境（使用完毕后）
deactivate
```

### 方法二：全局安装

```bash
pip3 install -r requirements.txt
```

## 使用方法

### 1. 命令行版本 (mouse_clicker.py)

#### 基本用法

```bash
# 获取当前鼠标位置
python mouse_clicker.py --position

# 单击指定坐标
python mouse_clicker.py --click 100 200

# 双击指定坐标
python mouse_clicker.py --double-click 100 200

# 右键点击指定坐标
python mouse_clicker.py --right-click 100 200

# 连续点击（坐标 间隔时间 次数）
python mouse_clicker.py --continuous 100 200 10 1.0

# 拖拽操作（起始X 起始Y 结束X 结束Y）
python mouse_clicker.py --drag 100 100 200 200

# 添加延迟（3秒后执行）
python mouse_clicker.py --click 100 200 --delay 3
```

#### 交互模式

直接运行程序进入交互模式：

```bash
python mouse_clicker.py
```

### 2. 图形界面版本 (mouse_clicker_gui.py)

```bash
python mouse_clicker_gui.py
```

图形界面提供以下功能：

- **屏幕信息显示**：实时显示屏幕尺寸和鼠标位置
- **坐标设置**：手动输入坐标或获取当前鼠标位置
- **基本点击操作**：单击、双击、右键点击按钮
- **连续点击设置**：设置点击次数和间隔时间
- **拖拽操作**：设置起始和结束坐标进行拖拽
- **延迟设置**：设置操作前的等待时间
- **操作日志**：实时显示操作记录

## 安全提示

1. **紧急停止**：将鼠标快速移动到屏幕左上角可以紧急停止所有操作
2. **延迟设置**：建议设置适当的延迟时间，给自己准备时间
3. **坐标确认**：执行操作前请确认坐标位置正确
4. **权限要求**：在macOS上可能需要授予辅助功能权限

## 权限设置（macOS）

在macOS系统上，需要授予Python辅助功能权限：

1. 打开 **系统偏好设置** > **安全性与隐私** > **隐私**
2. 选择 **辅助功能**
3. 点击锁图标解锁设置
4. 添加Python或终端应用到允许列表

## 常见问题

### Q: 程序无法点击或提示权限错误
A: 请确保已授予辅助功能权限（见上方权限设置）

### Q: 如何停止正在运行的连续点击？
A: 
- 命令行版本：按 Ctrl+C
- GUI版本：点击"停止"按钮
- 紧急情况：将鼠标移到屏幕左上角

### Q: 坐标如何确定？
A: 
- 使用 `--position` 参数获取当前鼠标位置
- GUI版本中点击"获取当前位置"按钮
- 使用系统自带的截图工具查看坐标

## 注意事项

- 请谨慎使用自动点击功能，避免对系统造成意外操作
- 建议在测试环境中先验证坐标和操作
- 连续点击时注意设置合理的间隔时间
- 使用前请关闭重要应用程序，避免误操作

## 技术说明

- 基于 `pyautogui` 库实现
- 支持跨平台使用（Windows、macOS、Linux）
- GUI界面使用 `tkinter` 构建
- 包含线程安全的连续操作功能

## 许可证

本项目仅供学习和个人使用，请遵守相关法律法规。